---
title: useRef
categories: [React]
comments: true
---

# useRef란?
특정 DOM을 선택할때 사용,  
컴포넌트가 리렌더링 될 때마다 계속 기억되야할 어떤 값을 관리할 때 사용됨

- 예제
    ``` javascript
    // useRef 불러오기
    import React, { useState, useRef } from 'react';

    function InputSample() {
        const [inputs, setInputs] = useState({
            name: '',
            nickname: '',
        });

        // useRef 호출
        const nameInput = useRef();

        const { name, nickname } = inputs;

        const onChange = (e) => {
            const { name, value } = e.target;

            setInputs({
                ...inputs,
                [name]: value,
            });
        };

        const onReset = () => {
            setInputs({
                name: '',
                nickname: '',
            });
            // current가 DOM을 가르키게 되므로 원하는 작업 실행
            nameInput.current.focus();
        };

        return (
            <div>
                <input 
                    name='name' 
                    placeholder='이름' 
                    onChange={onChange} 
                    value={name} 
                    ref={nameInput} // 만든 객체를 원하는 DOM에 설정
                />
                <input 
                    name='nickname' 
                    placeholder='닉네임' 
                    onChange={onChange} 
                    value={nickname} 
                />
                <button onClick={onReset}>초기화</button>
                <div>
                    <b>값: </b>
                    {name} ({nickname})
                </div>
            </div>
        )
    }

    export default InputSample;
    ```

## 배열에서 useRef사용

- App.js
    ``` javascript
    import React, { useState, useRef } from 'react';
    import CreateUser from './components/CreateUser';
    import UserList from './components/UserList';
    import './App.css';

    function App() {
    // useState 생성
    const [inputs, setInputs] = useState({
        username: '',
        email: '',
    });
    // inputs에서 각자 추출
    const { username, email } = inputs;

    // onChange 생성
    const onChange = (e) => {
        const { name, value } = e.target;
        setInputs({
        // 스프레드는 객체를 복사해오는 것
        ...inputs,
        // name에 따라 value 값을 바꿈
        [name]: value
        })
    }

    // users 배열 
    // useState로 감싸서 state상태로 만들어줌
    const [users, setUsers] = useState([
        {
            id: 1,
            username: 'kaen',
            email: 'kusdsuna@naver.com',
            // username에 색 상태를 관리하기 위해 생성
            active: true,
        },
        {
            id: 2,
            username: 'kusdsuna',
            email: 'kusdsuna@gmail.com',
            active: false,
        },
        {
            id: 3,
            username: 'lshdkyk',
            email: 'lshdkyk@nate.com',
            active: false,
        }
    ]);

    // 계속 변경사항을 유지하는 값
    const nextId = useRef(4);

    // input 값이 바뀔때 호출시킬 함수
    // 새로운 input을 만들 함수
    const onCreate = () => {
        // 새로운 user 객체 생성
        const user = {
        id: nextId.current,
        username,
        email,
        };
        setUsers([...users, user]); // 기존 항목을 복사해서 user라는 새항목에 넣어줌
        // 클릭될때 input에 있는 값을 지움
        setInputs({
        username: '',
        email: ''
        });
        nextId.current += 1; // nextId를 1씩 증가
    };

    // onRemove 함수 생성
    const onRemove = (id) => {
        // filter함수는 배열에서 특정 조건을 만족하는 원소들만 추출해서 새로운 배열을 만들어줌
        {/*} 각 user 객체 중에서 user.id가 파라미터와 일치하지 않는 것만 추출한 후 setUsers로 넣어주면
        삭제 시킬 것만 제외한 새로운 배열만 남게됨 */}
        setUsers(users.filter((user) => user.id !== id));
    }

    // onToggle 함수 생성
    const onToggle = (id) => {
        // map은 특정 아이템을 업데이트 할 수도 있음
        setUsers(users.map(
        (user) => user.id === id
            ? { ...user, active: !user.active } // 불변성을 지키기 위해 ...user 사용
            : user
        ));
    };

    return (
        <>
        <CreateUser 
            username={username}
            email={email}
            onChange={onChange}
            onCreate={onCreate}
        />
        {/* users를 props로 넣어줌 */}
        <UserList users={users} onRemove={onRemove} onToggle={onToggle} />
        </>
    );
    }
    export default App;
    ```

- UserList.js
    ``` javascript
    import React from 'react';

    function User({ user, onRemove, onToggle }) {
        // 구조분해로 코드 단축
        const { username, email, id, active } = user;
        return (
            <div>
                <b 
                    style={{
                        // active의 boolean상태에 따라 색상 변경
                        color: active ? 'green' : 'black',
                        cursor: 'pointer'
                    }}
                    onClick={() => onToggle(id)}
                >
                    {username}
                </b>
                &nbsp;
                <span>({email})</span>
                {/* 해당 id값에 파라미터를 넣어서 호출 */}
                <button onClick={() => onRemove(id)}>삭제</button>
            </div>
        );
    }

    function UserList({ users, onRemove, onToggle }) {
        return (
            <div>
                {
                    // map 함수로 불변성을 지키면서 코드 단축
                    users.map(
                        (user) => (
                            <User 
                                user={user} 
                                key={user.id} 
                                onRemove={onRemove} 
                                onToggle={onToggle}
                            />
                        )
                    )
                }
            </div>
        );
    }

    export default UserList;
    ```

- CreateUser.js
    ``` javascript
    import React from 'react';

    function CreateUser({ username, email, onChange, onCreate }) {
        return (
            <div>
                <input 
                    name='username' 
                    placeholder='계정명' 
                    onChange={onChange} 
                    value={username} 
                />
                <input 
                    name='email' 
                    placeholder='이메일' 
                    onChange={onChange} 
                    value={email} 
                />
                <button onClick={onCreate}>등록</button>
            </div>
        );
    }

    export default CreateUser;
    ```