---
title: api 연동
categories: [REACT]
comments: true
---

# api 연동이란?

- axios 라이브러리 설치

  ```
  yarn add axios
  ```

- 사용법

  ```jsx
  import axios from "axios";

  axios.메소드방식("HTTP메소드", { 해당정보 });
  /* axios.get('/users/1'); */
  ```

  예시

  ```jsx
  axios.post("/users", {
    username: "kaen",
    name: "sunghun",
  });
  ```

- API를 요청할때 관리 순서

1. 요청의 결과
2. 로딩 상태
3. 에러

## rest api

클라이언트와 서버가 소통하는 방식으로 HTTP 메서드 방식으로 소통

- HTML 메서드 방식 종류
  |||
  |-|-|
  |GET|데이터 조회|
  |POST|데이터 등록|
  |PUT|데이터 수정|
  |DELETE|데이터 제거|

- 메서드 예시
  |예시|설명|
  |-|-|
  |GET /users|모든 사용자의 계정을 반환|
  |GET /users/1|아이디가 1인 계정 데이터를 반환|
  |POST /articles|특정 정보를 등록|
  |GET /articles|모든 게시글 정보를 불러옴|
  |GET /articles/1|아이디가 1인 게시글 정보를 불러옴|
  |DELETE /articles/1|아이디가 1인 게시물을 삭제|
  |PUT /articles/1|아이디가 1인 게시물을 수정|

컴포넌트에서 API로 데이터를 요청하는 기본적인 방법은 useState와 useEffect로 데이터를 로딩하는 것

## 기본 구현

```jsx
import React, { useState, useEffect } from "react";
import axios from "axios";

function Users() {
  // 결과물
  const [users, setUsers] = useState(null);

  // 로딩
  const [loading, setLoading] = useState(false);

  // 에러
  const [error, setError] = useState(null);

  // 새로고침하기 위해 useEffect 밖으로 함수를 꺼냈음
  const fetchUsers = async () => {
    try {
      setUsers(null);
      setError(null);
      setLoading(true);
      // await사용
      const response = await axios.get(
        "https://jsonplaceholder.typicode.com/users/"
      );
      // 결과값을 확인
      setUsers(response.data);
    } catch (e) {
      // 발생한 에러값을 받아줌
      setError(e);
    }
    // 로딩이 끝났다고 알림
    setLoading(false);
  };

  // 처음 렌더링 될때 API를 요청
  useEffect(() => {
    // 함수 호출
    fetchUsers();
  }, []);

  // 만약 로딩 중이라면
  if (loading) return <div>로딩중..</div>;
  // 만약 에러가 있다면
  if (error) return <div>에러가 발생했습니다</div>;
  // 만약 로딩이 끝났지만 users가 유효하지 않다면
  if (!users) return null;

  return (
    <>
      <ul>
        {users.map((user) => (
          <li key={user.id}>
            {user.username} ({user.name})
          </li>
        ))}
      </ul>
      {/* 누를때마다 API함수가 호출됨 */}
      <button onClick={fetchUsers}>다시 불러오기</button>
    </>
  );
}

export default Users;
```
